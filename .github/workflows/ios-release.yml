      # --- Lint & (αν χρειαστεί) αναδημιουργία του ios/App/App/Info.plist χωρίς heredoc ---
      - name: Recreate Info.plist safely (no heredoc)
        shell: bash
        run: |
          set -e
          FILE="ios/App/App/Info.plist"
          if ! /usr/bin/plutil -lint "$FILE" >/dev/null 2>&1; then
            echo "⚠️  $FILE is invalid; recreating…"
            /usr/bin/plutil -create xml1 "$FILE"
            # Συντομογραφία για λιγότερο copy-paste
            PB="/usr/libexec/PlistBuddy -c"

            $PB 'Add :CFBundleDevelopmentRegion string en' "$FILE"
            $PB 'Add :CFBundleExecutable string $(EXECUTABLE_NAME)' "$FILE"
            $PB 'Add :CFBundleIdentifier string $(PRODUCT_BUNDLE_IDENTIFIER)' "$FILE"
            $PB 'Add :CFBundleInfoDictionaryVersion string 6.0' "$FILE"
            $PB 'Add :CFBundleName string $(PRODUCT_NAME)' "$FILE"
            $PB 'Add :CFBundlePackageType string APPL' "$FILE"
            $PB 'Add :CFBundleShortVersionString string $(MARKETING_VERSION)' "$FILE"
            $PB 'Add :CFBundleVersion string $(CURRENT_PROJECT_VERSION)' "$FILE"
            $PB 'Add :UILaunchStoryboardName string LaunchScreen' "$FILE"
            $PB 'Add :UIMainStoryboardFile string Main' "$FILE"

            # Capabilities / orientations
            $PB 'Add :UIRequiredDeviceCapabilities array' "$FILE"
            $PB 'Add :UIRequiredDeviceCapabilities:0 string arm64' "$FILE"

            $PB 'Add :UISupportedInterfaceOrientations array' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations:0 string UIInterfaceOrientationPortrait' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations:1 string UIInterfaceOrientationLandscapeLeft' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations:2 string UIInterfaceOrientationLandscapeRight' "$FILE"

            $PB 'Add :UISupportedInterfaceOrientations~ipad array' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations~ipad:0 string UIInterfaceOrientationPortrait' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations~ipad:1 string UIInterfaceOrientationPortraitUpsideDown' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations~ipad:2 string UIInterfaceOrientationLandscapeLeft' "$FILE"
            $PB 'Add :UISupportedInterfaceOrientations~ipad:3 string UIInterfaceOrientationLandscapeRight' "$FILE"

            # Scene manifest (Capacitor)
            $PB 'Add :UIApplicationSceneManifest dict' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UIApplicationSupportsMultipleScenes bool false' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations dict' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations:UIWindowSceneSessionRoleApplication array' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations:UIWindowSceneSessionRoleApplication:0 dict' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations:UIWindowSceneSessionRoleApplication:0:UISceneConfigurationName string Default Configuration' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations:UIWindowSceneSessionRoleApplication:0:UISceneDelegateClassName string $(PRODUCT_MODULE_NAME).SceneDelegate' "$FILE"
            $PB 'Add :UIApplicationSceneManifest:UISceneConfigurations:UIWindowSceneSessionRoleApplication:0:UISceneStoryboardFile string Main' "$FILE"

            # Usage descriptions (πρόσθεσε κι άλλα αν χρειάζεσαι)
            $PB 'Add :NSCameraUsageDescription string We use the camera to let you take photos.' "$FILE"
            $PB 'Add :NSPhotoLibraryUsageDescription string We need photo library access to select images.' "$FILE"
            $PB 'Add :NSPhotoLibraryAddUsageDescription string We save images to your library when requested.' "$FILE"
            $PB 'Add :NSUserTrackingUsageDescription string This identifier will be used to deliver a better app experience.' "$FILE"

            /usr/bin/plutil -lint "$FILE"
            echo "✅ Recreated valid Info.plist"
          else
            echo "✅ Info.plist is valid — no action."
          fi
